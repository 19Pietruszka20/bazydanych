-- A
-- ZAD. 2


SELECT NAZWISKO 
FROM PRACOWNICY AS P
WHERE P.NAZWISKO LIKE 'K%' ;


-- ZAD. 3


SELECT TEMAT
FROM TEMATY, PRACOWNICY
WHERE PRACOWNICY.NR_PRAC=TEMATY.NR_PRAC_KT 
AND PRACOWNICY.NAZWISKO='MISIURA' ;


-- ZAD.6


SELECT NAZWISKO
FROM PRACOWNICY AS P, TEMATY AS T, PRZYDZIALY AS PRZ
WHERE P.PLEC = 'M' 
AND T.NR_TEM = PRZ.NR_PRAC
AND PRZ.NR_PRAC = P.NR_PRAC
AND (T.TEMAT = 'GUPTA' OR T.TEMAT = 'DYSK') 
GROUP BY NAZWISKO
ORDER BY NAZWISKO DESC;


-- ZAD.8


SELECT T.TEMAT, TN.TEMAT 
FROM TEMATY AS T LEFT OUTER JOIN TEMATY AS TN ON T.NR_TEM = TN.NR_TEM_NADRZ;


-- ZAD.9


SELECT COUNT (KOD_FUNKCJI)
FROM PRZYDZIALY AS PR, PRACOWNICY AS P
WHERE P.NR_PRAC = PR.NR_PRAC
AND P.NAZWISKO = 'MISIURA';


-- ZAD.12


SELECT TEMAT, COUNT (KWOTA), SUM (KWOTA)
FROM WYPLATY AS W, TEMATY AS T
WHERE T.NR_TEM = W.NR_TEM
GROUP BY TEMAT, T.NR_TEM; 


-- ZAD.14


SELECT MIN(DATA_UR), KOD_FUNKCJI
FROM PRACOWNICY AS P, PRZYDZIALY AS PRZ
WHERE PRZ.NR_PRAC=P.NR_PRAC
GROUP BY KOD_FUNKCJI;




-- ZAD.16


SELECT TEMAT
FROM TEMATY AS T, WYPLATY AS W
WHERE T.NR_TEM = W.NR_TEM
GROUP BY TEMAT, T.NR_TEM
HAVING ((SUM(W.KWOTA)) < 400);


-- ZAD.17


SELECT NAZWISKO
FROM PRACOWNICY AS P, TEMATY AS T, PRZYDZIALY AS PRZ
WHERE P.NR_PRAC = PRZ.NR_PRAC
AND PRZ.NR_TEM = T.NR_TEM
GROUP BY NAZWISKO, P.NR_PRAC
HAVING ((COUNT (DISTINCT T.NR_TEM)) > 5);


-- ZAD.18


SELECT TEMAT
FROM TEMATY AS T
WHERE T.DATA_ROZP < ( SELECT DATA_ROZP FROM TEMATY AS T WHERE T.TEMAT = 'DYSK' );


-- ZAD.19


SELECT NAZWISKO
FROM PRACOWNICY AS P, WYPLATY AS W
WHERE P.NR_PRAC = W.NR_PRAC
GROUP BY NAZWISKO, P.NR_PRAC
HAVING ((SUM(W.KWOTA)) > (SELECT SUM(KWOTA) FROM WYPLATY AS W, PRACOWNICY AS P
                        WHERE P.NAZWISKO = 'MISIURA' AND P.NR_PRAC = W.NR_PRAC));


-- ZAD.20


SELECT TEMAT
FROM TEMATY T, PRACOWNICY P,PRZYDZIALY AS PRZ
WHERE P.NR_PRAC = PRZ.NR_PRAC
GROUP BY TEMAT, T.NR_TEM
HAVING ((COUNT(PRZ.NR_PRAC)) > (SELECT COUNT(NR_PRAC) FROM PRZYDZIALY AS PRZ, TEMATY AS T
                                WHERE T.TEMAT = 'DYSK' AND T.NR_TEM = PRZ.NR_TEM));
